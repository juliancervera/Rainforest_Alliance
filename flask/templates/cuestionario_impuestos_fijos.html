<!DOCTYPE html>
<html>
<head>
    <title>Cuestionario impuestos fijos</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}">
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            document.addEventListener("keydown", function(event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                }
            });
        });
    </script>
    <script>
        var rowCounter = 1;

        function addRow() {
            var table = document.getElementById("impuestos_fijos_table");
            var newRow = table.insertRow();
            rowCounter++;
            newRow.innerHTML = `
                <td><input type="text" name="impuesto_fijo_${rowCounter}" value="" maxlength="23"></td>
                <td><input type="number" name="monto_${rowCounter}" value="">
                <td><input type="number" name="porcentaje_${rowCounter}" value="100" min="0" max="100"></td>
                <td><input type="number" name="monto_total_${rowCounter}" value="" style="background-color: lightgrey;" readonly></td>
            `;
            document.getElementById("rowCounterInput").value = rowCounter;
        }
    </script>
</head>
<body>
    <h1>Impuestos fijos relacionados con el producto {{ producto }}</h1>
    <p>Notas: Si el impuesto pagado involucra más de un producto o si el periodo cubierto por el pago del impuesto es mayor al tiempo de producción del producto en cuestión, indique qué porcentaje del impuesto correspone al producto en cuestión. Por ejemplo, si usted paga impuestos por la posesión de un predio donde cultiva cuatro productos diferentes en cantidades iguales, escriba 25% en la columna "Porcentaje correspondiente al producto".              
</p>
    {% if impuestos_fijos %}
            <br>
        <a href="{{ url_for('cuestionario_impuestos_fijos') }}"><button class="button">Deshacer y repetir registro</button></a>
        <a href="{{ url_for('pregunta_costos_certificacion') }}"><button class="button">Continuar</button></a>
            <br>
    <p>Éstos son los impuestos fijos que usted registró:</p>
    <table>
        <tr>
            <th>Nombre del impuesto</th>
            <th>Monto</th>
            <th>Porcentaje correspondiente al producto {{ producto }}</th>
            <th>Monto total</th>
        </tr>
        {% for sublist in impuestos_fijos %}
        <tr>
            <td>{{ sublist[0] }}</td>
            <td>{{ sublist[1] }}</td>
            <td>{{ sublist[2] }}</td>
            <td>{{ sublist[3] }}</td>
        </tr>
        {% endfor %}
    </table>
            <br>
        <a href="{{ url_for('cuestionario_impuestos_fijos') }}"><button class="button">Deshacer y repetir registro</button></a>
        <a href="{{ url_for('pregunta_costos_certificacion') }}"><button class="button">Continuar</button></a>
            <br>

    <br>
    <div class="center-aligned">
    <button id="deleteButton" class="send_form" style="background-color: #FF4F4B;"><b>BORRAR TODO Y<br>REGRESAR A INICIO</b></button>
    <div id="confirmationModal" class="modal-reset">
      <div class="modal-reset-content">
        <p>¿Está seguro/a de querer borrar todo y regresar a la página de inicio?</p>
        <div>
          <button class="send_form" id="confirmYes" style="background-color: #FF4F4B;">Sí</button>
          <button class="send_form" id="confirmNo" style="background-color: #99EE90;">No</button>
        </div>
      </div>
    </div>
    </div>
    {% else %}
    <p>A continuación, registre los impuestos fijos:</p>
    <form action="{{ url_for('cuestionario_impuestos_fijos') }}" method="post">
        <table id="impuestos_fijos_table"> 
            <tr>
                <th>Nombre del impuesto</th>
                <th>Monto</th>
                <th>Porcentaje correspondiente al producto {{ producto }}</th>
                <th>Monto total</th>
            </tr>
            <tr>
                <td><input type="text" name="impuesto_fijo_1" value="" maxlength="23"></td>
                <td><input type="number" name="monto_1" value="">
                <td><input type="number" name="porcentaje_1" value="100" min="0" max="100"></td>
                <td><input type="number" name="monto_total_1" value="" style="background-color: lightgrey;" readonly></td>
            </tr>
        </table>
        <input type="hidden" id="rowCounterInput" name="rowCounter" value="1">
        <button type="button" class="add_row" onclick="addRow()">Agregar fila</button>
        <br>
        <div class="center-aligned">
        <button type="submit" class="send_form">REGISTRAR COSTOS</button>
        </div>
        <br>
        <br>
    </form>
    <div class="center-aligned">
    <a href="{{ url_for('pregunta_costos_certificacion') }}"><button class="send_form" style="background-color: #FF6865">OMITIR PÁGINA Y CONTINUAR</button></a>
    </div>
    {% endif %}
</body>
<script>
        // Function to show the confirmation modal
        function showConfirmationModal() {
          const modal = document.getElementById("confirmationModal");
          modal.style.display = "block";
        }

        // Function to close the confirmation modal
        function closeConfirmationModal() {
          const modal = document.getElementById("confirmationModal");
          modal.style.display = "none";
        }

        // Function to redirect to the index page
        function redirectToIndexPage() {
          window.location.href = "/";
        }

        // Event listener for the "Borrar todo y regresar a inicio" button
        document.getElementById("deleteButton").addEventListener("click", showConfirmationModal);

        // Event listener for the "Sí" button in the confirmation modal
        document.getElementById("confirmYes").addEventListener("click", function() {
          redirectToIndexPage();
        });

        // Event listener for the "No" button in the confirmation modal
        document.getElementById("confirmNo").addEventListener("click", function() {
          closeConfirmationModal();
        });
</script>
</html>